(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{478:function(s,a,t){"use strict";t.r(a);var e=t(8),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[a("strong",[s._v("由于Centos7自带的openssh版本过低且存在漏洞，所以为了安全考虑我们需要升级openssh到最高版本。")])]),s._v(" "),a("h3",{attrs:{id:"一-关闭防火墙并检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-关闭防火墙并检查"}},[s._v("#")]),s._v(" 一. 关闭防火墙并检查")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 停止防火墙")]),s._v("\nsystemctl stop firewalld\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看系统版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/redhat-release\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看软件版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qa")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" openssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-V")]),s._v("\n")])])]),a("h3",{attrs:{id:"二-安装工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-安装工具"}},[s._v("#")]),s._v(" 二. 安装工具")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" gcc "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])])]),a("h3",{attrs:{id:"三-下载软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-下载软件"}},[s._v("#")]),s._v(" 三. 下载软件")]),s._v(" "),a("p",[s._v("阿里镜像站：https://mirrors.aliyun.com/pub/OpenBSD")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--insecure")]),s._v(" https://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.11/zlib-1.2.11.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--insecure")]),s._v(" https://mirrors.sonic.net/pub/OpenBSD/OpenSSH/portable/openssh-9.3p1.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--insecure")]),s._v(" https://www.openssl.org/source/openssl-1.1.1t.tar.gz\n")])])]),a("h3",{attrs:{id:"四-解压并安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-解压并安装"}},[s._v("#")]),s._v(" 四. 解压并安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 解压")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" zlib-1.2.11.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" openssh-9.3p1.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" openssl-1.1.1t.tar.gz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 安装")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" zlib-1.2.11\n./configure "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zlib\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssl-1.1.1t\n./config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/ssl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" shared\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/local/ssl/lib'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/ld.so.conf\nldconfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssh-9.3p1\n./configure "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/openssh --with-zlib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zlib --with-ssl-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/ssl\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),a("h3",{attrs:{id:"五-删除低版本openssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-删除低版本openssh"}},[s._v("#")]),s._v(" 五. 删除低版本OpenSSH")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rpm -e --nodeps `rpm -qa | grep openssh`\n")])])]),a("h3",{attrs:{id:"六-修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六-修改配置"}},[s._v("#")]),s._v(" 六. 修改配置")]),s._v(" "),a("p",[a("code",[s._v("vi /usr/local/openssh/etc/sshd_config")])]),s._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[s._v("PermitRootLogin yes\nPubkeyAuthentication yes\nPasswordAuthentication yes\n")])])]),a("h3",{attrs:{id:"七-复制文件到相应的系统文件夹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七-复制文件到相应的系统文件夹"}},[s._v("#")]),s._v(" 七. 复制文件到相应的系统文件夹")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssh-9.3p1/contrib/redhat/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" sshd.init /etc/init.d/sshd\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--add")]),s._v(" sshd\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/etc/sshd_config /etc/ssh/sshd_config\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/sbin/sshd /usr/sbin/sshd\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/bin/ssh /usr/bin/ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/bin/ssh-keygen /usr/bin/ssh-keygen\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/etc/ssh_host_ecdsa_key.pub /etc/ssh/ssh_host_ecdsa_key.pub\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/ssl/bin/openssl /usr/bin/\n")])])]),a("h3",{attrs:{id:"八-启动sshd服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八-启动sshd服务"}},[s._v("#")]),s._v(" 八. 启动sshd服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl status sshd\nsystemctl start sshd\nsystemctl status sshd\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-V")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启防火墙")]),s._v("\nsystemctl start firewalld\n")])])]),a("h3",{attrs:{id:"参看资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参看资料"}},[s._v("#")]),s._v(" 参看资料：")]),s._v(" "),a("ul",[a("li",[s._v("centos.pkgs.org/7/centos-x86_64/fontconfig-2.13.0-4.3.el7.x86_64.rpm.html")])])])}),[],!1,null,null,null);a.default=n.exports}}]);