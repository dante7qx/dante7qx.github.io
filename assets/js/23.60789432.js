(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{368:function(t,a,s){t.exports=s.p+"assets/img/audit_hist.6daa7b17.png"},450:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("框架添加了审计历史的功能，主版本精灵框架已包含此功能，老版本框架若要使用，请进行如下操作，集成功能:")]),t._v(" "),a("h2",{attrs:{id:"一-下载源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-下载源码"}},[t._v("#")]),t._v(" 一. 下载源码")]),t._v(" "),a("p",[t._v("下载"),a("a",{attrs:{href:"https://github.com/dante7qx/springboot3-ruoyi/tree/func-integration/audithist-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("审计历史"),a("OutboundLink")],1),t._v("插件。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:s(368),alt:"audithist"}}),t._v(" "),a("h2",{attrs:{id:"二-插件集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-插件集成"}},[t._v("#")]),t._v(" 二. 插件集成")]),t._v(" "),a("h3",{attrs:{id:"_1-system"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-system"}},[t._v("#")]),t._v(" 1. system")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("system")]),t._v(" 目录下的"),a("code",[t._v("domain、mapper、service")]),t._v("复制到你的"),a("code",[t._v("[项目]-system")]),t._v("中")]),t._v(" "),a("p",[a("code",[t._v("xml")]),t._v("中文件复制到"),a("code",[t._v("[项目]-system/src/main/resources/mapper/system")]),t._v("中")]),t._v(" "),a("h3",{attrs:{id:"_2-common"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-common"}},[t._v("#")]),t._v(" 2. common")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("common")]),t._v(" 目录下的文件复制到你"),a("code",[t._v("[项目]-common")]),t._v("对应的目录中")]),t._v(" "),a("h3",{attrs:{id:"_3-framework"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-framework"}},[t._v("#")]),t._v(" 3. framework")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("framework")]),t._v(" 目录下的文件复制到你"),a("code",[t._v("[项目]-framework")]),t._v("对应的目录中")]),t._v(" "),a("h3",{attrs:{id:"_4-admin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-admin"}},[t._v("#")]),t._v(" 4. admin")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("admin")]),t._v(" 目录下的文件复制到你"),a("code",[t._v("[项目]-admin/src/main/java/com/spirit/web/controller/monitor")]),t._v("中")]),t._v(" "),a("h3",{attrs:{id:"_5-ui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-ui"}},[t._v("#")]),t._v(" 5. ui")]),t._v(" "),a("p",[t._v("将 "),a("code",[t._v("ui")]),t._v(" 目录下的文件复制到你"),a("code",[t._v("[项目]-ui")]),t._v("对应的目录中")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("views/audithist")]),t._v("  ——>  "),a("code",[t._v("src/views/monitor/")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("caq.js")]),t._v("         ——>  "),a("code",[t._v("src/api/monitor/")])])])]),t._v(" "),a("h3",{attrs:{id:"_6-执行sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-执行sql"}},[t._v("#")]),t._v(" 6. 执行SQL")]),t._v(" "),a("p",[t._v("在你的项目中，执行"),a("code",[t._v("sql/V1_11__init_audit_hist.sql")])]),t._v(" "),a("h3",{attrs:{id:"_7-修改baseentity-java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-修改baseentity-java"}},[t._v("#")]),t._v(" 7. 修改"),a("code",[t._v("BaseEntity.java")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** 搜索值 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@AuditIgnore")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" searchValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** 请求参数 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@AuditIgnore")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"三-使用说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-使用说明"}},[t._v("#")]),t._v(" 三. 使用说明")]),t._v(" "),a("h3",{attrs:{id:"_1-添加注解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-添加注解"}},[t._v("#")]),t._v(" 1. 添加注解")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("Service")]),t._v("中，新增、修改、删除方法上添加注解"),a("code",[t._v("@AuditHist(bizClazz = Demo.class, op = BusinessType.INSERT)")]),t._v("，例如:")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@AuditHist")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bizClazz "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Demo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" op "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BusinessType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INSERT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Demo")]),t._v(" demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCreateBy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUsername")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCreateTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNowDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" demoMapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-忽略审计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-忽略审计"}},[t._v("#")]),t._v(" 2. 忽略审计")]),t._v(" "),a("p",[t._v("若某些字段不需要进行审计，可以在字段上添加注解 "),a("code",[t._v("@AuditIgnore")])]),t._v(" "),a("h3",{attrs:{id:"_3-demo示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-demo示例"}},[t._v("#")]),t._v(" 3. Demo示例")]),t._v(" "),a("p",[t._v("Demo示例，可参考："),a("code",[t._v("src/views/biz/demo/index.vue")])])])}),[],!1,null,null,null);a.default=e.exports}}]);