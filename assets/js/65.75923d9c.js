(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{426:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("strong",[s._v("由于Centos7自带的openssh版本过低且存在漏洞，所以为了安全考虑我们需要升级openssh到最高版本。")])]),s._v(" "),t("h3",{attrs:{id:"一-关闭防火墙并检查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-关闭防火墙并检查"}},[s._v("#")]),s._v(" 一. 关闭防火墙并检查")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 停止防火墙")]),s._v("\nsystemctl stop firewalld\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看系统版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/redhat-release\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看软件版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" openssh\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -V\n")])])]),t("h3",{attrs:{id:"二-安装工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-安装工具"}},[s._v("#")]),s._v(" 二. 安装工具")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" gcc "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])])]),t("h3",{attrs:{id:"三-下载软件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-下载软件"}},[s._v("#")]),s._v(" 三. 下载软件")]),s._v(" "),t("p",[s._v("阿里镜像站：https://mirrors.aliyun.com/pub/OpenBSD")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L -O --insecure https://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.11/zlib-1.2.11.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L -O --insecure https://mirrors.sonic.net/pub/OpenBSD/OpenSSH/portable/openssh-9.3p1.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L -O --insecure https://www.openssl.org/source/openssl-1.1.1t.tar.gz\n")])])]),t("h3",{attrs:{id:"四-解压并安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-解压并安装"}},[s._v("#")]),s._v(" 四. 解压并安装")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf zlib-1.2.11.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf openssh-9.3p1.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf openssl-1.1.1t.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 安装")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" zlib-1.2.11\n./configure --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zlib\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssl-1.1.1t\n./config --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/ssl -d shared\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/local/ssl/lib'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/ld.so.conf\nldconfig -v\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssh-9.3p1\n./configure --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/openssh --with-zlib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/zlib --with-ssl-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/ssl\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),t("h3",{attrs:{id:"五-删除低版本openssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五-删除低版本openssh"}},[s._v("#")]),s._v(" 五. 删除低版本OpenSSH")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rpm -e --nodeps `rpm -qa | grep openssh`\n")])])]),t("h3",{attrs:{id:"六-修改配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六-修改配置"}},[s._v("#")]),s._v(" 六. 修改配置")]),s._v(" "),t("p",[t("code",[s._v("vi /usr/local/openssh/etc/sshd_config")])]),s._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[s._v("PermitRootLogin yes\nPubkeyAuthentication yes\nPasswordAuthentication yes\n")])])]),t("h3",{attrs:{id:"七-复制文件到相应的系统文件夹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七-复制文件到相应的系统文件夹"}},[s._v("#")]),s._v(" 七. 复制文件到相应的系统文件夹")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssh-9.3p1/contrib/redhat/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" sshd.init /etc/init.d/sshd\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --add sshd\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/etc/sshd_config /etc/ssh/sshd_config\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/sbin/sshd /usr/sbin/sshd\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/bin/ssh /usr/bin/ssh\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/bin/ssh-keygen /usr/bin/ssh-keygen\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/openssh/etc/ssh_host_ecdsa_key.pub /etc/ssh/ssh_host_ecdsa_key.pub\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/ssl/bin/openssl /usr/bin/\n")])])]),t("h3",{attrs:{id:"八-启动sshd服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八-启动sshd服务"}},[s._v("#")]),s._v(" 八. 启动sshd服务")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("systemctl status sshd\nsystemctl start sshd\nsystemctl status sshd\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -V\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 开启防火墙")]),s._v("\nsystemctl start firewalld\n")])])]),t("h3",{attrs:{id:"参看资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参看资料"}},[s._v("#")]),s._v(" 参看资料：")]),s._v(" "),t("ul",[t("li",[s._v("centos.pkgs.org/7/centos-x86_64/fontconfig-2.13.0-4.3.el7.x86_64.rpm.html")])])])}),[],!1,null,null,null);t.default=e.exports}}]);