(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{381:function(t,s,a){t.exports=a.p+"assets/img/webcrt.701e6c6a.png"},382:function(t,s,a){t.exports=a.p+"assets/img/config_ffmpeg.9a24d5dd.png"},383:function(t,s,a){t.exports=a.p+"assets/img/ffmpeg.a6ef9c03.png"},473:function(t,s,a){"use strict";a.r(s);var r=a(8),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"一-概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一-概述"}},[t._v("#")]),t._v(" 一. 概述")]),t._v(" "),s("p",[t._v("精灵视频监控解析平台基于开源项目 "),s("a",{attrs:{href:"https://github.com/deepch/RTSPtoWeb",target:"_blank",rel:"noopener noreferrer"}},[t._v("RTSPtoWeb"),s("OutboundLink")],1),t._v("，进行二次研发。平台用于将您的 RTSP 流转换为可在 Web 浏览器中使用的格式，\n例如：MSE、WebRTC 或 HLS。 它是完全原生的 Golang，无需使用 FFmpeg 或 GStreamer！")]),t._v(" "),s("h2",{attrs:{id:"二-使用说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二-使用说明"}},[t._v("#")]),t._v(" 二. 使用说明")]),t._v(" "),s("h3",{attrs:{id:"_1-下载平台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载平台"}},[t._v("#")]),t._v(" 1. 下载平台")]),t._v(" "),s("p",[t._v("精灵视频监控解析平台，联系作者进行下载。目录结构如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("├── config.json                   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 配置文件")]),t._v("\n├── config.json.example.json      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 配置样例")]),t._v("\n├── examples                      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 页面集成样例")]),t._v("\n│   ├── hls                       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## hls 集成样例")]),t._v("\n│   ├── hlsll                     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## hlsll 集成样例")]),t._v("\n│   ├── mse                       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## mse 集成样例")]),t._v("\n│   └── webrtc                    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## webrtc 集成样例")]),t._v("\n├── run                           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Linux 可执行文件")]),t._v("\n├── run.exe                       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Windows 可执行文件")]),t._v("\n├── runMAC                        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## MacOS 可执行文件")]),t._v("\n└── web                           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 平台控制台页面")]),t._v("\n    ├── static\n    └── templates\n")])])]),s("h3",{attrs:{id:"_2-配置并运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置并运行"}},[t._v("#")]),t._v(" 2. 配置并运行")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"channel_defaults"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"server"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_debug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_demo"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_dir"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_login"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_password"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userpassword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"http_port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":8083"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https_auto_tls"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https_auto_tls_name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https_cert"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https_key"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"https_port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ice_credential"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ice_servers"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stun:stun.l.google.com:19302"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ice_username"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"log_level"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rtsp_port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('":5541"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"token"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"backend"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enable"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webrtc_port_max"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webrtc_port_min"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"streams"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"channels"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"摄像头1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"on_demand"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<rtsp地址>"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"测试"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("配置说明")]),t._v(" "),s("p",[t._v("使用时只可修改下面的配置，其他的配置不要进行修改")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Server 配置")])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("配置项")]),t._v(" "),s("th",[t._v("配置值")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("debug")]),t._v(" "),s("td",[t._v("true (false)，默认：true")]),t._v(" "),s("td",[t._v("启用调试输出")])]),t._v(" "),s("tr",[s("td",[t._v("log_level")]),t._v(" "),s("td",[t._v("trace, debug, info, warning, error, fatal, or panic，默认：info")]),t._v(" "),s("td",[t._v("日志级别")])]),t._v(" "),s("tr",[s("td",[t._v("http_login")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("认证用户名")])]),t._v(" "),s("tr",[s("td",[t._v("http_password")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("认证密码")])]),t._v(" "),s("tr",[s("td",[t._v("http_port")]),t._v(" "),s("td",[t._v("默认:8083（注意，要带:，例如:8000）")]),t._v(" "),s("td",[t._v("HTTP端口")])]),t._v(" "),s("tr",[s("td",[t._v("webrtc_port_min")]),t._v(" "),s("td",[t._v("默认0，可设置为 60000")]),t._v(" "),s("td",[t._v("WebRTC使用的最小端口（UDP）")])]),t._v(" "),s("tr",[s("td",[t._v("webrtc_port_max")]),t._v(" "),s("td",[t._v("默认0，可设置为 61000")]),t._v(" "),s("td",[t._v("WebRTC使用的最大端口（UDP）")])])])]),t._v(" "),s("p",[s("strong",[t._v("注意：")]),t._v(" 修改"),s("code",[t._v("http_login")]),t._v("或"),s("code",[t._v("http_password")]),t._v("后，要同步修改"),s("code",[t._v("index.js")]),t._v("(位于"),s("code",[t._v("web/static/js/index.js")]),t._v(")")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 替换")]),t._v("\nxhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Basic "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("btoa")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<原始用户名>:<原始密码>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为")]),t._v("\nxhr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Basic "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("btoa")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<新用户名>:<新密码>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("strong",[t._v("Stream 配置")])])]),t._v(" "),s("p",[t._v("服务启动可不配置"),s("code",[t._v("streams")]),t._v("，通过平台控制台进行添加。对示例配置进行说明")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[t._v("test：视频流解析标识（重要）\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("0：")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("  视频流通道标识（重要，按顺序配置0、1、2、3、4）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("url：")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("RTSP地址")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("运行方式")]),t._v(" "),s("ul",[s("li",[t._v("Windows：双击"),s("code",[t._v("run.exe")])]),t._v(" "),s("li",[t._v("Linux："),s("code",[t._v("./run")])]),t._v(" "),s("li",[t._v("MacOS："),s("code",[t._v("./runMac")])])]),t._v(" "),s("p",[t._v("运行后，打开浏览器，输入地址："),s("code",[t._v("http://<ip>:<port>")]),t._v("（本地启动的地址默认是：http://localhost:8083）")])])]),t._v(" "),s("h3",{attrs:{id:"_3-集成web页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-集成web页面"}},[t._v("#")]),t._v(" 3. 集成Web页面")]),t._v(" "),s("p",[t._v("平台已经提供了集成Web页面的示例，详情请查看"),s("code",[t._v("examples")]),t._v("目录下的文件。")]),t._v(" "),s("h3",{attrs:{id:"_4-限制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-限制"}},[t._v("#")]),t._v(" 4. 限制")]),t._v(" "),s("p",[t._v("支持的视频编解码器： 所有"),s("code",[t._v("H264")]),t._v("配置（不支持"),s("code",[t._v("H265")]),t._v("）")]),t._v(" "),s("p",[t._v("支持的音频编解码器：否")]),t._v(" "),s("h2",{attrs:{id:"三-延时对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三-延时对比"}},[t._v("#")]),t._v(" 三. 延时对比")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("采用技术")]),t._v(" "),s("th",[t._v("延迟")]),t._v(" "),s("th",[t._v("监控路数")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("WebRTC")]),t._v(" "),s("td",[t._v("< 1s")]),t._v(" "),s("td",[t._v("不限（ios不支持）")])]),t._v(" "),s("tr",[s("td",[t._v("MSE")]),t._v(" "),s("td",[t._v("1s 左右")]),t._v(" "),s("td",[t._v("< 6路")])]),t._v(" "),s("tr",[s("td",[t._v("LL-HLS")]),t._v(" "),s("td",[t._v("2～3s")]),t._v(" "),s("td",[t._v("不限")])]),t._v(" "),s("tr",[s("td",[t._v("HLS")]),t._v(" "),s("td",[t._v("> 20s")]),t._v(" "),s("td",[t._v("不限")])])])]),t._v(" "),s("h2",{attrs:{id:"四-对接实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四-对接实践"}},[t._v("#")]),t._v(" 四. 对接实践")]),t._v(" "),s("p",[t._v("设置完视频流后，可以通过API获取对应的信息。")]),t._v(" "),s("p",[s("code",[t._v("GET /stream/{STREAM_ID}/info")])]),t._v(" "),s("p",[t._v("鉴权方式：Basic Auth")]),t._v(" "),s("p",[t._v("示例："),s("code",[t._v("curl -u <username>:<password> http:<ip>:<port>/stream/{STREAM_ID}/info")])]),t._v(" "),s("p",[t._v("响应：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"payload"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test video"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"channels"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"0"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ch1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rtsp://admin:admin@{YOUR_CAMERA_IP}/uri"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"on_demand"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ch2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rtsp://admin:admin@{YOUR_CAMERA_IP}/uri"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"on_demand"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"debug"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"五-技术原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五-技术原理"}},[t._v("#")]),t._v(" 五. 技术原理")]),t._v(" "),s("h3",{attrs:{id:"_1-视频监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-视频监控"}},[t._v("#")]),t._v(" 1. 视频监控")]),t._v(" "),s("p",[t._v("监控系统中摄像头的作用是将所采集的图像数据进行编码，而硬盘录像机的作用就是对摄像头编码的数据进行解码，然后输出到显示器，这样就能看到完整\n和清晰的监控图像。")]),t._v(" "),s("ul",[s("li",[t._v("监控路数：视频监控系统里面的路数指的是你安装了多少摄像头（硬盘录像机），一般规格有4路、8路、16路和32路四种规格。")]),t._v(" "),s("li",[t._v("IPC：IP Camera，网络摄像头的意思")])]),t._v(" "),s("h3",{attrs:{id:"_2-rtsp协议"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-rtsp协议"}},[t._v("#")]),t._v(" 2. RTSP协议")]),t._v(" "),s("p",[t._v("RTSP(Real Time Streaming Protocol)，实时流传输协议，是TCP/IP协议体系中的一个应用层协。RTSP可以是双向的，客户机和服务器都可以发出请求。\nRTSP是用来控制声音或影像的多媒体串流协议，并允许同时多个串流需求控制，传输时所用的网络通讯协定并不在其定义的范围内，服务器端可以自行选择使用TCP或UDP来传送串流内容，它的语法和运作跟HTTP 1.1类似，但并不特别强调时间同步，所以比较能容忍网络延迟。")]),t._v(" "),s("p",[t._v("参考：https://www.jianshu.com/p/4e3925f98e84")]),t._v(" "),s("h3",{attrs:{id:"_3-hls和ll-hls"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-hls和ll-hls"}},[t._v("#")]),t._v(" 3. HLS和LL-HLS")]),t._v(" "),s("p",[s("strong",[t._v("HLS")])]),t._v(" "),s("blockquote",[s("p",[t._v("HLS（HTTP Live Streaming）协议是由苹果提出的基于流媒体的网络传输协议。通过将整条流切割成一个个小的可以通过 HTTP 下载的媒体文件，然后提供一个配套的媒体列表文件，\n提供给客户端，让客户端顺序地拉取这些媒体文件播放，来实现看上去是在播放一条流的效果。由于传输层协议只需要标准的 HTTP 协议，HLS 可以方便的透过防火墙或者代理服务器，而且可以很方便的利用 CDN 进行分发加速，并且客户端实现起来也很方便。")]),t._v(" "),s("p",[t._v("HLS 把整个流分成一个个小的基于 HTTP 的文件来下载，每次只下载一些。HLS 协议由三部分组成：HTTP、M3U8、TS。这三部分中，HTTP 是传输协议，M3U8 是索引文件，TS 是音视频的媒体信息。")]),t._v(" "),s("p",[t._v("HLS的延迟：HLS的一个分片大概5-10s,一般加载3个分片播放。所以延迟大概15-30s。")])]),t._v(" "),s("p",[s("strong",[t._v("LL-HLS")])]),t._v(" "),s("blockquote",[s("p",[t._v("Low-Latency HLS。相比较于HLS，延迟更低，官方说明，最低延迟在3s左右。")]),t._v(" "),s("p",[s("strong",[t._v("更小的分片划分")])]),t._v(" "),s("p",[t._v("LL-HLS将大的分片且分为一个个较小的分片, 这种切分方式不是简单的将源分片等分, 而是结合fMP4封装和#EXT-X-MAP规则, 将整视频的头部和内容分开, 而且内容源被划分的很细, 例如原来一个分片6s左右, 可能被切分为30个200ms的fMP4分片, 这些分片使用#EXT-X-PART来标注.")]),t._v(" "),s("p",[s("strong",[t._v("增量更新")])]),t._v(" "),s("p",[t._v("不发送完整的播放列表，而是发送播放列表的增量（默认的播放列表被保存，然后只在出现时发送增量，而不是发送完整的播放列表）")]),t._v(" "),s("p",[s("strong",[t._v("服务器阻塞，消除轮询")])]),t._v(" "),s("p",[t._v("服务器的责任是保留请求（阻塞），直到包含新片段的播放列表版本可用。阻断播放列表的重新加载消除了轮询")]),t._v(" "),s("p",[s("strong",[t._v("预加载支持")])]),t._v(" "),s("p",[t._v("通过EXT-X-PRELOAD-HINT标签，来声明即将产生的片段。客户端可以提前发起请求，当该片段生成时立即回复给客户端。")])]),t._v(" "),s("h3",{attrs:{id:"_4-mse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-mse"}},[t._v("#")]),t._v(" 4. MSE")]),t._v(" "),s("p",[t._v("MSE（Media Source Extensions）媒体源扩展 API 提供了实现无插件且基于 Web 的流媒体的功能。使用 MSE，媒体串流能够通过 JavaScript 创建， 并且能通过使用"),s("code",[t._v("<audio>")]),t._v("和"),s("code",[t._v("<video>")]),t._v("元素进行播放。")]),t._v(" "),s("h3",{attrs:{id:"_5-webrtc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-webrtc"}},[t._v("#")]),t._v(" 5. WebRTC")]),t._v(" "),s("p",[t._v("WebRTC (Web Real-Time Communications)，由Google发起的实时通讯解决方案，其中包含视频音频采集，编解码，数据传输，音视频展示等功能。")]),t._v(" "),s("p",[t._v("参考资料：https://zhuanlan.zhihu.com/p/86751078")]),t._v(" "),s("h2",{attrs:{id:"六-常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六-常见问题"}},[t._v("#")]),t._v(" 六. 常见问题")]),t._v(" "),s("h3",{attrs:{id:"_1-无法播放webrtc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-无法播放webrtc"}},[t._v("#")]),t._v(" 1. 无法播放WebRTC")]),t._v(" "),s("p",[t._v("WebRTC端口被防火墙拦截，需要进行如下操作：")]),t._v(" "),s("ul",[s("li",[t._v("修改"),s("code",[t._v("config.json")]),t._v("，设置")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webrtc_port_max"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("61000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webrtc_port_min"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("服务器开放端口，在终端执行命令")]),t._v(" "),s("p",[t._v("Linux")])])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v(" firewall-cmd --add-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),t._v("-61000/udp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n firewall-cmd "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v("\n")])])]),s("p",[t._v("​\t\tWindows")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:a(381),alt:"webcrt"}}),t._v(" "),s("h2",{attrs:{id:"七-h265编码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七-h265编码"}},[t._v("#")]),t._v(" 七. H265编码")]),t._v(" "),s("p",[t._v("上述操作，只是针对所有视频编解码器为"),s("code",[t._v("H264")]),t._v("的RTSP视频流。那对于编码为 "),s("code",[t._v("H265")]),t._v("的RTSP视频流，按照如下方式进行集成。")]),t._v(" "),s("h3",{attrs:{id:"_1-安装-ffmpeg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-ffmpeg"}},[t._v("#")]),t._v(" 1. 安装 ffmpeg")]),t._v(" "),s("p",[t._v("因为需要通过"),s("code",[t._v("ffmpeg")]),t._v("将H264/H265转到mpeg1，然后将对应的音视频格式的流通过websocket分发到jsmpeg客户端。所以在服务器上安装"),s("code",[t._v("ffmpeg")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("下载地址: "),s("a",{attrs:{href:"https://www.gyan.dev/ffmpeg/builds/ffmpeg-git-full.7z",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.gyan.dev/ffmpeg/builds/ffmpeg-git-full.7z"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("将"),s("code",[t._v("ffmpeg")]),t._v("配置到系统PATH中，配置后，打开命令行窗口，验证是否成功")]),t._v(" "),s("ul",[s("li",[t._v("配置")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(382),alt:"config_ffmpeg"}})]),t._v(" "),s("ul",[s("li",[t._v("验证")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(383),alt:"ffmpeg"}})])])]),t._v(" "),s("h3",{attrs:{id:"_2-运行后台程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-运行后台程序"}},[t._v("#")]),t._v(" 2. 运行后台程序")]),t._v(" "),s("p",[t._v("下载的svn项目，找到"),s("code",[t._v("h265")]),t._v("目录")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("h265\n├── index.html            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n├── index2.html           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n├── jsmpeg.js             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 依赖的第三方js")]),t._v("\n├── spirit-rtsp            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Linux 可执行文件")]),t._v("\n└── spirit-rtsp.exe        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Windows 可执行文件")]),t._v("\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Windows 环境运行")]),t._v("\nspirit-rtsp.exe\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Linux 环境运行")]),t._v("\n./spirit-rtsp\n")])])]),s("p",[t._v("端口号，默认是 3000。自定义端口号，可配置系统环境变量 "),s("code",[t._v("RTSP_PORT=<自定义端口>")])]),t._v(" "),s("h3",{attrs:{id:"_3-页面集成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-页面集成"}},[t._v("#")]),t._v(" 3. 页面集成")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("精灵框架: 最新版框架（发布于2023-09-25）已经集成，老框架项目可联系作者进行集成")])]),t._v(" "),s("li",[s("p",[t._v("非分离版项目: 参考 index.html、index2.html")])])]),t._v(" "),s("h3",{attrs:{id:"_4-示例说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-示例说明"}},[t._v("#")]),t._v(" 4. 示例说明")]),t._v(" "),s("ol",[s("li",[t._v("获取页面可播放地址")])]),t._v(" "),s("p",[t._v("将需要播放的RTSP流地址提交到 /stream/play 接口，例如：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('POST /stream/play\n{\n   "url": "rtsp://admin:password@192.168.3.10:554/cam/realmonitor?channel=1&subtype=0"\n}\n')])])]),s("p",[t._v("后台可以正常转换此RTSP地址时便会返回一个对应的地址，例如：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('{\n    "code": 0,\n    "data": {\n        "path": "/stream/live/5b96bff4-bdb2-3edb-9d6e-f96eda03da56"\n    },\n    "msg": "success"\n}\n')])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("修改示例"),s("code",[t._v("index2.html")])])]),t._v(" "),s("p",[s("code",[t._v('const playUri = [ "/stream/live/e8e99fc7-448a-3a83-807c-b03426504cbb", "/stream/live/365d049c-c78c-389a-8379-b565dc19bfb2" ]')])]),t._v(" "),s("p",[t._v("替换成接口返回的")]),t._v(" "),s("p",[s("code",[t._v("data[path]")])])])}),[],!1,null,null,null);s.default=e.exports}}]);